<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Consignment Note - {{ cnote.cnote_number|default:"" }}</title>

    <style>
        @page { size: A4; margin: 0; }

        body {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 10.8pt;
            margin: 0;
            padding: 0;
            color: #000;
            background: white;
            line-height: 1.28;
        }

        .a4-page {
            width: 210mm;
            height: 297mm;
            margin: 0 auto;
            padding: 7mm 10mm;
            box-sizing: border-box;
        }

        .lr-box {
            border: 1.5px solid #000;
            padding: 6mm 8mm;
            margin-bottom: 10mm;
            box-sizing: border-box;
            background: white;
        }

        /* ================= HEADER ================= */

        .header-row {
            position: relative;
            width: 100%;
            margin-bottom: 5mm;
        }

        .header-left {
            display: inline-block;
            width: calc(100% - 90px);
        }

        .logo-img {
            width: 80px;
            height: auto;
            margin-right: 12mm;
            vertical-align: top;
        }

        .company-name {
            font-size: 22pt;
            font-weight: bold;
        }

        .company-info {
            font-size: 10pt;
            line-height: 1.4;
        }

        .qr-box {
            position: absolute;
            top: 0;
            right: 0;
            width: 80px;
            text-align: center;
        }

        .qr-box img {
            width: 70px;
            height: 70px;
            object-fit: contain;
        }

        .qr-text {
            font-size: 9px;
            font-weight: 600;
            margin-top: 2px;
        }

        /* ================= CONTENT ================= */

        .title {
            font-size: 16pt;
            font-weight: bold;
            text-align: center;
            margin: 6px 0 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5px;
        }

        th, td {
            border: 1px solid black;
            padding: 4px 6px;
            vertical-align: top;
            font-size: 10.5pt;
        }

        .top-row td {
            font-weight: bold;
            text-align: center;
            font-size: 11pt;
        }

        .right { text-align: right; }
        .bold { font-weight: bold; }
        .small { font-size: 9.2pt; }
        .no-border { border: none !important; }

        .terms {
            font-size: 8.8pt;
            line-height: 1.25;
            margin-top: 8px;
        }

        .signature-row td {
            border: none;
            padding-top: 20px;
            font-size: 10pt;
        }

        /* ================= PRINT ================= */

        @media print {
            body { margin: 0 !important; }
            * { -webkit-print-color-adjust: exact; }
        }
    </style>
</head>

<body>
<div class="a4-page">

<!-- ================= COPY 1 ================= -->
<div class="lr-box">

    <div class="header-row">
        <div class="header-left">
            <img src="{% static 'logo/Ceejay_logo.png' %}" class="logo-img">
            <div style="display:inline-block; vertical-align:top;">
                <div class="company-name">CEE JAY COURIER</div>
                <div class="company-info">
                    DOOR NO:38/1385-A1, CHANDRATHIL ROAD EDAPPALLY, PIN-682024<br>
                    GST 32AKQPP7985H2ZD | MSME NO: UDYAM-KL-02-0058521<br>
                    Phone: 6238275151 | Email: logistics@ceejaycourrier.com
                </div>
            </div>
        </div>

        <div class="qr-box">
            <img src="data:image/png;base64,{{ qr_code }}">
            <div class="qr-text">Scan for LR</div>
        </div>
    </div>

    <div class="title">CONSIGNMENT NOTE</div>

    <table>
        <tr class="top-row">
            <td>DATE: {{ cnote.date|date:"d-m-Y" }}</td>
            <td>{{ cnote.payment|upper }}</td>
            <td>TOTAL PIECES {{ cnote.total_item|default:"1" }}</td>
            <td>{{ cnote.cnote_number }}</td>
        </tr>
    </table>

    <table>
        <tr>
            <th>FROM: {{ cnote.booking_branch.broker.broker_name|default:"-" }}</th>
            <th>Destination: {{ cnote.destination.location_name|default:"-" }}</th>
            <th>Charges</th>
            <th class="right">Amount</th>
        </tr>

        <tr>
            <td colspan="2" rowspan="6">
                <b>CONSIGNOR</b><br>
                {{ cnote.consignor.consignor_name }}<br>
                CONTACT: {{ cnote.consignor.consignor_phone|default:"-" }}<br><br>
                <b>CONSIGNEE</b><br>
                {{ cnote.consignee.consignee_name }}<br>
                {{ cnote.consignee.consignee_address|default:"-" }}<br>
                CONTACT: {{ cnote.consignee.consignee_phone|default:"-" }}
            </td>
            <td>Freight</td>
            <td class="right">{{ cnote.freight|floatformat:2 }}</td>
        </tr>

        <tr><td>LR Charges</td><td class="right">{{ cnote.lr_charge|floatformat:2 }}</td></tr>
        <tr><td>Pickup Charge</td><td class="right">{{ cnote.pickup_charge|floatformat:2 }}</td></tr>
        <tr><td>Hamali</td><td class="right">{{ cnote.hamali_charge|floatformat:2 }}</td></tr>
        <tr><td>Unloading</td><td class="right">{{ cnote.unloading_charge|floatformat:2 }}</td></tr>
        <tr><td>Other</td><td class="right">{{ cnote.other_charge|floatformat:2 }}</td></tr>

        <tr>
            <td colspan="2" class="small">
                <b>ITEM DESCRIPTION</b><br>
                {{ cnote.description|default:"BOX(1)" }}<br>
                Remarks: {{ cnote.remarks|default:"" }}
            </td>
            <td class="bold">TOTAL</td>
            <td class="right bold">{{ cnote.total|floatformat:2 }}</td>
        </tr>
    </table>

    <div class="terms">
        <b>Terms & Conditions:</b><br>
        All disputes subject to Calicut jurisdiction only.
    </div>

    <table>
        <tr class="signature-row">
            <td>Receiver Signature</td>
            <td style="text-align:right;">Clerk / Agent: {{ cnote.booking_branch.broker.broker_name }}</td>
        </tr>
    </table>

</div>

<!-- ================= COPY 2 (duplicate safely) ================= -->
<div class="lr-box">

    <div class="header-row">
        <div class="header-left">
            <img src="{% static 'logo/Ceejay_logo.png' %}" class="logo-img">
            <div style="display:inline-block; vertical-align:top;">
                <div class="company-name">CEE JAY COURIER</div>
                <div class="company-info">
                    DOOR NO:38/1385-A1, CHANDRATHIL ROAD EDAPPALLY, PIN-682024<br>
                    GST 32AKQPP7985H2ZD | MSME NO: UDYAM-KL-02-0058521<br>
                    Phone: 6238275151 | Email: logistics@ceejaycourrier.com
                </div>
            </div>
        </div>

        <div class="qr-box">
            <img src="data:image/png;base64,{{ qr_code }}">
            <div class="qr-text">Scan for LR</div>
        </div>
    </div>

    <div class="title">CONSIGNMENT NOTE</div>

    <table>
        <tr class="top-row">
            <td>DATE: {{ cnote.date|date:"d-m-Y" }}</td>
            <td>{{ cnote.payment|upper }}</td>
            <td>TOTAL PIECES {{ cnote.total_item|default:"1" }}</td>
            <td>{{ cnote.cnote_number }}</td>
        </tr>
    </table>

    <table>
        <tr>
            <th>FROM: {{ cnote.booking_branch.broker.broker_name|default:"-" }}</th>
            <th>Destination: {{ cnote.destination.location_name|default:"-" }}</th>
            <th>Charges</th>
            <th class="right">Amount</th>
        </tr>

        <tr>
            <td colspan="2" rowspan="6">
                <b>CONSIGNOR</b><br>
                {{ cnote.consignor.consignor_name }}<br>
                CONTACT: {{ cnote.consignor.consignor_phone|default:"-" }}<br><br>
                <b>CONSIGNEE</b><br>
                {{ cnote.consignee.consignee_name }}<br>
                {{ cnote.consignee.consignee_address|default:"-" }}<br>
                CONTACT: {{ cnote.consignee.consignee_phone|default:"-" }}
            </td>
            <td>Freight</td>
            <td class="right">{{ cnote.freight|floatformat:2 }}</td>
        </tr>

        <tr><td>LR Charges</td><td class="right">{{ cnote.lr_charge|floatformat:2 }}</td></tr>
        <tr><td>Pickup Charge</td><td class="right">{{ cnote.pickup_charge|floatformat:2 }}</td></tr>
        <tr><td>Hamali</td><td class="right">{{ cnote.hamali_charge|floatformat:2 }}</td></tr>
        <tr><td>Unloading</td><td class="right">{{ cnote.unloading_charge|floatformat:2 }}</td></tr>
        <tr><td>Other</td><td class="right">{{ cnote.other_charge|floatformat:2 }}</td></tr>

        <tr>
            <td colspan="2" class="small">
                <b>ITEM DESCRIPTION</b><br>
                {{ cnote.description|default:"BOX(1)" }}<br>
                Remarks: {{ cnote.remarks|default:"" }}
            </td>
            <td class="bold">TOTAL</td>
            <td class="right bold">{{ cnote.total|floatformat:2 }}</td>
        </tr>
    </table>

    <div class="terms">
        <b>Terms & Conditions:</b><br>
        All disputes subject to Calicut jurisdiction only.
    </div>

    <table>
        <tr class="signature-row">
            <td>Receiver Signature</td>
            <td style="text-align:right;">Clerk / Agent: {{ cnote.booking_branch.broker.broker_name }}</td>
        </tr>
    </table>

</div>

</div>
</body>
</html>
